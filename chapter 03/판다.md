## HTTP 메시지
- HTTP에 따라 교환하는 정보를 말한다.
- 리퀘스트 측 메시지는 리퀘스트 메시지 / 리스폰스 측 메시지는 리스폰스 메시지
- `메시지 헤더`와 `메시지 바디`로 구성된 텍스트 문자열
- 최초로 나타나는 `개행 문자 (CR+LF)` 로 헤더와 바디를 구분

* 메시지 헤더: 리퀘스트와 리스폰스 내용 및 속성
* 메시지 바디: 전송되는 데이터


## 리퀘스트 메시지와 리스폰스 메시지

### 리퀘스트 메시지의 구조
* 메시지 헤더
  - 리퀘스트 라인 : HTTP 메소드와 URI, HTTP 버전 정보
  - 리퀘스트 헤더 필드 : `Accept`, `Authorization`, `Range`, `Host` 등 리퀘스트의 부가적 정보, 클라이언트의 정보, 요청 콘텐츠의 우선 순위 등에 대한 정보
  - 일반 헤더 필드 : `Connection`, `Date`, `Pragma` 등 리퀘스트와 리스폰스 메시지에 모두 사용되는 헤더
  - 엔티티 헤더 필드 : `Allow`, `Content-Type` 등 메시지 바디에 담긴 엔티티에 관한 부가 정보
  - etc. (쿠키 등)
  
* 메시지 바디


### 리스폰스 메시지의 구조
* 메시지 헤더
  - 상태 라인 : 상태 코드와 HTTP 버전 정보
  - 리스폰스 헤더 필드 : `Age`, `Location`, `Accept-Ranges` 등 리스폰스의 부가적 정보, 서버의 정보, 클라이언트에 요구하는 사항 등에 대한 정보
  - 일반 헤더 필드 :  :리퀘스트 메시지의 엔티티 헤더 필드와 동일
  - etc. (쿠키 등)
  
* 메시지 바디

## 인코딩

- 데이터 전송 시 인코딩을 통해 전송 효율을 개선
- 다량의 액세스를 빠르게 처리할 수 있지만, 별도의 인코딩 처리가 필요하므로 CPU 등의 리소스를 소모

### 메시지 v. 엔티티
- 메시지 : HTTP 통신의 기본 단위 / `옥텟 시퀀스`로 구성
- 엔티티 : 리퀘스트/리스폰스의 페이로드로 전송되는 정보 / `엔티티 헤더 필드`와 `엔티티 바디`로 구성

### 콘텐츠 코딩 (Content Coding) 
- 엔티티 정보를 유지한 채로 압축하는 기능
- 인코딩된 엔티티는 수신측에서 디코딩

### 청크 전송 코딩 (Chunked Transfer Coding)
- 엔티티 바디를 분할하는 기능
- 엔티티 바디를 `청크` 단위로 분해 / 각각의 청크는 청크 사이즈를 16진수로 표현해서 구분 / 엔티티 바디 끝에는 `0(CR+LF)`를 기록
- 인코딩된 엔티티 바디는 수신측에서 디코딩 


## 멀티파트

- 복수의 데이터를 한 번에 보내기 위한 기능
- 하나의 메시지 바디에 복수의 엔티티를 포함하여 전송할 수 있다.
- `Content-Type` 헤더 필드를 사용하여 선언
- 각각의 파트마다 헤더 필드를 가지고, 멀티파트 내부에 멀티파트가 존재할 수 있다.
- `boundary` 문자열을 통해 각각의 파트를 구분한다.  

* multipart/form-data
  - 웹 폼에서 파일을 업로드 할 때 사용

* multipart/byteranges
  - 레인지 리퀘스트에 대응하는 리스폰스 메시지가 여러 범위의 내용을 포함할 때 사용


## 레인지 리퀘스트

- 대용량의 데이터를 한 번에 전송하게 되면, 전송 중 커넥션이 끊겼을 때 다시 처음부터 시작해야 함.
- Resume 기능을 제공하기 위해 범위를 지정해서 리퀘스트를 보낼 필요성이 있다. 
- `Range` 헤더 필드를 사용해서 리소스의 바이트 레인지를 지정한다. 
- 성공하면 `206 Partial Content`를 응답. 
- 서버가 레인지 리퀘스트를 지원하지 않으면 200 코드로 전체 리소스가 반환된다. 


## 콘텐츠 네고시에이션 

- 클라이언트가 선호하는 리소스를 제공하기 위해 클라이언트와 서버가 협상
- 리퀘스트 메시지에 포함된 `협상 헤더`를 기준으로 판단
- 협상 헤더에는 `q-value` 라는 우선순위 값이 존재하여, q-value가 높은 것부터 / 구체적인 것부터 응답한다.  
ex) 서버에서 영어만 제공하는 상황에서 `Accept-Language: ko;1, en;0.8, jp;0.7` 과 같은 리퀘스트를 보내면 영어로 응답. 
