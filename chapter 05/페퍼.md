# 웹 서버
## 가상 호스트
- 물리적으로 1대인 서버를 가상으로 여러 대가 있는 것처럼 설정할 수 있다.
- 웹 호스팅을 제공하는 1개의 서버에서 여러 고객의 웹 사이트를 넣어, 각각 다른 웹 사이트를 실행할 수 있게 한다.
- HTTP를 사용해서 클라이언트가 서버에 액세스하는 경우. 리퀘스트가 서버에 도착한 시점에는 IP 주소를 기준으로 액세스
  - 도메인 명 --(DNS)--> IP 주소
  - 같은 서버 상에 같은 IP 주소의 웹 서버인 경우, DNS로 이름을 해결할 수 없다. 같은 수신인이 된다.
  - 따라서 호스트명과 도메인 명을 완전하게 포함한 URI를 지정하거나, 반드시 Host 헤더 필드에서 지정해야한다.

## 통신을 중계하는 프로그램
HTTP는 `클라이언트 - 서버` 연결 외에 통신을 중계하는 프로그램과 서버 연계도 가능하다.
통신을 중계하는 프로그램과 서버는 그 다음에 있는 다른 서버에 리퀘스트를 중계하고, 그 서버로부터 받은 리스폰스를 클라이언트에 반환한다.

### 프록시
<img width="521" alt="image" src="https://user-images.githubusercontent.com/28749734/169681015-f202d428-5f90-484c-b2da-e35b4cef04fc.png">

`클라이언트` ↔️ `프록시 서버` ↔️ `오리진 서버`. 서버와 클라이언트의 양쪽 역할  
- 클라이언트에게 받은 리퀘스트를 URI의 변경 없이 리소스를 가지고 있는 서버로 전송. 오리진 서버(리소스의 본체를 가진 서버)로부터 되돌아온 리스폰스를 클라이언트에게 전달.
- HTTP 통신 시, 여러 대의 프록시 서버를 경유할 수 있다. `Via` 헤더 필드에 경유한 호스트 정보를 추가해야한다.
 
사용 목적
- 캐시를 사용해서 네트워크 대역 등을 효율적으로 사용 가능하다.
- 조직 내에 특정 웹 사이트에 대한 액세스 제한, 액세스 로그를 획득하는 정책을 철저하게 지킬 수 있다.

캐싱 프록시
- 프록시 서버 상에 리소스 캐시를 보존해 두는 프록시 타입
- 프록시에 같은 리소스에 대한 리퀘스트가 온 경우, 오리진 서버로부터 리소스를 획득하는 것이 아닌, 캐시를 리스폰스로서 응답

투명 프록시
- 프록시로 리퀘스트와 리스폰스를 중계를 할 때 메시지 변경을 하지 않는 프록시 타입.
- ↔️ 비투과 프록시(메시지를 변경함)

### 게이트웨이
<img width="481" alt="image" src="https://user-images.githubusercontent.com/28749734/169680999-873c66ac-e8a5-4987-a5f8-5a0dc34040a8.png">  
`클라이언트` ↔️ `게이트웨이` ↔️ `HTTP 이외의 서버`  

- 사용 목적) 프록시와 유사한 동작 방식이지만 게이트웨이는 HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용한다.  
- 게이트웨이 다음에 있는 서버가 HTTP 서버 이외의 서비스를 제공하는 서버가 된다.
- ex) 클라이언트와 게이트웨이 사이를 암호화하여 안전하게 접속하도록 통신의 안전성을 높임, DB에 접속해 SQL 쿼리로 데이터를 얻는 곳에 이용, 신용 카드 결제 시스템과 연계하는 경우, 무선 공유기

### 터널
요구에 따라 다른 서버와의 통신 경로를 확립. 클라이언트는 SSL 같은 암호화 통신을 통해 서버와 안전하게 통신 가능 
터널은 HTTP 리퀘스트를 해석하지 않고 그대로 다음 서버에 중계
통신하고 있는 양 끝의 접속이 끊어지면 자동으로 종료

## 캐시
- 프록시 서버와 클라이언트의 로컬 디스크에 보관된 리소스의 사본
- 사용 목적) 리소스를 가진 서버에 액세스를 줄여 통신량과 통신 시간을 절약 가능
- 캐시 서버는 프록시 서버의 하나로 캐싱 프록시로 분류한다.
- 서버는 같은 리퀘스트를 매번 처리하지 않을 수 있다.

유효성
- 오리진 서버의 리소스가 갱신되어도 캐시 서버에서 갱신 전의 리소스를 그대로 응답할 수 있다.
- 캐시가 존재하더라도 클라이언트의 요구나 캐시의 유효 기간에 따라 오리진 서버에서 리소스의 유효성을 확인하거나 새로운 리소스를 획득해야한다.

클라이언트의 캐시
인터넷 임시 파일: 인터넷 익스플로러에서 클라이언트가 보존하는 캐시
브라우저에서 유효한 캐시를 가진 경우, 같은 리소스는 서버에 요청하지 않고, 로컬 디스크로부터 가져온다.
캐시 서버와 마찬가지로 리소스가 오래되었다고 판단된 경우, 오리진 서버를 확인한다.

## 참고 자료
- https://coding-start.tistory.com/342
- https://velog.io/@hyun-jii/%ED%94%84%EB%A1%9D%EC%8B%9CProxy-vs-%EA%B2%8C%EC%9D%B4%ED%8A%B8%EC%9B%A8%EC%9D%B4Gateway
